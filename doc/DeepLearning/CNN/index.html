<!DOCTYPE html>
<html class="no-js" lang="en" >
  <head>
    <link rel="shortcut icon" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" />

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Shuto" />
    <meta name="twitter:card" content="summary">
    <meta property="og:url" content="https://iwasakishuto.github.io/Kerasy/doc/DeepLearning/CNN/index.html" />
    <meta property="og:title" content="CNN">
    <meta property="og:description" content="Brief explanation of CNN and introduction of modules that can be used in Kerasy">
    <meta property="og:image" content="https://iwasakishuto.github.io/images/FacebookImage/Kerasy.png"/>
    <meta property="og:type" content="article" />

    <title>CNN - Kerasy Documentation</title>
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/custom.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/jupyter.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/theme_extra.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/theme.css">

    <script>
      // Current page data
      var mkdocs_page_name = "CNN";
      var mkdocs_page_input_path = "DeepLearning/CNN.md";
      var mkdocs_page_url = "/Kerasy/DeepLearning/CNN/";
    </script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/jquery-2.1.1.min.js" defer></script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/modernizr-2.8.3.min.js" defer></script>
    <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/theme.js" defer></script>

    <!-- Common CSS in my portofolio  -->
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/jupyter.css">
    <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/custom.css" media="screen">
    <link rel="apple-touch-icon" sizes="152x152" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" type="image/png" />
    <!-- Use fontawesome Icon -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" rel="stylesheet" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <!-- Syntax highlight -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
    <!-- Custom CSS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        }
      });
    </script>
    <!-- Mermaid -->
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" charset="UTF-8"></script>
    <script>
      mermaid.initialize({
        startOnLoad:true
      });
    </script>
    <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
  </head>
<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Kerasy Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../..">Home</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">DeepLearning</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        CNN
          <span class="toctree-expand"></span>
      </a>
    </li>
    

  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../Optimizers/">Optimizers</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../NeuralNetwork/">Neural Network</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../ComputationalGraph/">Computational Graph</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../Initializers/">Initializers</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">MachineLearning</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Decomposition/">Decomposition</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/sampling/">Sampling</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Linear Regression/">Linear Regression</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Cluster/">Cluster</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/HMM/">HMM</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/EM algorithm/">EM algorithm</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Tree/">Tree</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../MachineLearning/Support Vector Machine/">Support Vector Machine</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">BioInformatics</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Tandem Repeats/">Tandem Repeats</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/RefSeq/">RefSeq</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Secondary Structure/">Secondary Structure</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/Alignment/">Alignment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BioInformatics/String Search/">String Search</a>
  </li>
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Kerasy Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>DeepLearning &raquo;</li>
        
      
    
    <li>CNN</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/iwasakishuto/Kerasy"> Visit github &nbsp; <i class="fab fa-github"></i></a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div id="contents">
<div class="row">
    <div class="small-12 columns article">
        <div class="topRibbon">
          <h3>CNN</h3>
        </div>
        <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-30(金)</span></li>
            <li><span><i class="far fa-file-code"></i>&nbsp; <a href="https://github.com/iwasakishuto/Kerasy/blob/gh-pages/kerasy/layers/convolutional.py">convolutional.py</a></span></li>
            <!-- <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/deeplearning.html">DeepLearning</a></span></li> -->
        </ul>
    </div>
</div>
        <section class="article">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="admonition tip">
<p class="admonition-title">Notebook</p>
<p>Example Notebook: <a href="https://nbviewer.jupyter.org/github/iwasakishuto/Kerasy/blob/gh-pages/examples/MNIST.ipynb">Kerasy.examples.MNIST.ipynb</a></p>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CNN is originated from <strong>Neocognitron</strong>, which was devised based on the neurophysiological knowledge (<strong>visual cortex</strong> of the living organism's brain), and has a structure <strong>specialized for image processing.</strong></p>
<p>Neocognitron consists of:</p>
<ul>
<li><a href="#convolution">Convolutional Layer</a> : corresponding to simple cells (S-cells) for feature extraction </li>
<li><a href="#pooling">Pooling Layer</a> : corresponding to complex cells (C-cells) having a function of allowing positional deviation.</li>
</ul>
<p>CNN can learn well by using <strong>backpropagation</strong>. The algorithm is shown mathematically below.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="convolution">Convolutional Layer</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><span><i class="far fa-file-code"></i>  <a href="https://github.com/iwasakishuto/Kerasy/blob/gh-pages/kerasy/layers/convolutional.py">convolutional.py</a></span></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th style="text-align:center">Mono</th>
<th style="text-align:center">Multi</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img alt="Convolution-Mono-cha.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/Convolution-Mono-cha.png" /></td>
<td style="text-align:center"><img alt="Convolution-Multi-cha.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/Convolution-Multi-cha.png" /></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="forward">forward<a class="anchor-link" href="#forward">¶</a></h4><table>
<thead><tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img alt="forward1.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/forward1.png" /></td>
<td style="text-align:center"><img alt="forward2.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/forward2.png" /></td>
<td style="text-align:center"><img alt="forward3.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/forward3.png" /></td>
</tr>
<tr>
<td style="text-align:center"><img alt="forward4.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/forward4.png" /></td>
<td style="text-align:center"><img alt="forward5.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/forward5.png" /></td>
<td style="text-align:center"><img alt="forward6.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/forward6.png" /></td>
</tr>
</tbody>
</table>
$$
\begin{cases}
    \begin{aligned}
        a_{i,j,c'}^{{k+1}} 
        &= \sum_c\sum_{m=0}^{M-1}\sum_{n=0}^{N-1}w_{m,n,c,c'}^{k+1}z_{i+m,j+n,c}^{k} + b_{c'}^{k+1}\\
        z_{i,j,c'}^{{k}} 
        &= h^{k}\left(a_{i,j,c'}^{{k}}\right)
    \end{aligned}
\end{cases}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="backprop">backprop<a class="anchor-link" href="#backprop">¶</a></h4><p><img alt="backprop.gif" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop.gif" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<details>
<summary>Check image individually</summary>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img alt="backprop1.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop1.png" /></td>
<td style="text-align:center"><img alt="backprop2.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop2.png" /></td>
<td style="text-align:center"><img alt="backprop3.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop3.png" /></td>
<td style="text-align:center"><img alt="backprop4.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop4.png" /></td>
</tr>
<tr>
<td style="text-align:center"><img alt="backprop5.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop5.png" /></td>
<td style="text-align:center"><img alt="backprop6.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop6.png" /></td>
<td style="text-align:center"><img alt="backprop7.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop7.png" /></td>
<td style="text-align:center"><img alt="backprop8.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop8.png" /></td>
</tr>
<tr>
<td style="text-align:center"><img alt="backprop9.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop9.png" /></td>
<td style="text-align:center"><img alt="backprop10.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop10.png" /></td>
<td style="text-align:center"><img alt="backprop11.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop11.png" /></td>
<td style="text-align:center"><img alt="backprop12.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop12.png" /></td>
</tr>
<tr>
<td style="text-align:center"><img alt="backprop13.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop13.png" /></td>
<td style="text-align:center"><img alt="backprop14.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop14.png" /></td>
<td style="text-align:center"><img alt="backprop15.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop15.png" /></td>
<td style="text-align:center"><img alt="backprop16.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/convolution/backprop16.png" /></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>$w_{m,n,c,c'}^k, b_{c'}^k$
$$
\begin{aligned}
\frac{\partial E}{\partial w_{m,n,c,c'}^{k+1}} 
&= \sum_{i}\sum_{j}\frac{\partial E}{\partial a_{i,j,c'}^{k+1}}\frac{\partial a_{i,j,c'}^{k+1}}{\partial w_{m,n,c,c'}^{k+1}}\\
&= \sum_{i}\sum_{j}\frac{\partial E}{\partial a_{i,j,c'}^{k+1}}z_{i+m,j+n,c}^{k}\\
&= \sum_{i}\sum_{j}\delta_{i,j,c'}^{k+1}\cdot z_{i+m,j+n,c}^{k}\\
\frac{\partial E}{\partial b_{c'}^{k+1}} 
&= \sum_{i}\sum_{j}\delta_{i,j,c'}^{k+1}
\end{aligned}
$$</li>
<li>$\delta_{i,j,c}^k$
$$
\begin{aligned}
\delta_{i,j,c}^{k} 
&= \frac{\partial E}{\partial a_{i,j,c}^{k}} \\
&= \sum_{c'}\sum_{m=0}^{M-1}\sum_{n=0}^{N-1}\left(\frac{\partial E}{\partial a_{i-m,j-n,c'}^{k+1}}\right)\left(\frac{\partial a_{i-m,j-n,c'}^{k+1}}{\partial a_{i,j,c}^k}\right)\\ 
&= \sum_{c'}\sum_{m=0}^{M-1}\sum_{n=0}^{N-1} \left(\delta_{i-m,j-n,c'}^{k+1}\right)\left(w_{m,n,c,c'}^{k+1}h'\left(a_{i,j,c}^k\right)\right) \\
&= h'\left(a_{i,j,c}^k\right)\sum_{c'}\sum_{m=0}^{M-1}\sum_{n=0}^{N-1} \delta_{i-m,j-n,c'}^{k+1}\cdot w_{m,n,c,c'}^{k+1}
\end{aligned}
$$</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="pooling">Pooling Layer</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><span><i class="far fa-file-code"></i>  <a href="https://github.com/iwasakishuto/Kerasy/blob/gh-pages/kerasy/layers/pooling.py">pooling.py</a></span></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="forward">forward<a class="anchor-link" href="#forward">¶</a></h4><p><img alt="Max-Pooling-forward.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/pooling/max_pool_forward.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="backprop">backprop<a class="anchor-link" href="#backprop">¶</a></h4><p><img alt="Max-Pooling-backprop.png" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/CNN/pooling/max_pool_backprop.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ex.-MNIST">ex. MNIST<a class="anchor-link" href="#ex.-MNIST">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>MNIST database</strong> (Modified National Institute of Standards and Technology database) is a large <small>(60,000 training images and 10,000 testing images)</small> database of handwritten digits that is commonly used for training various image processing systems.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center"><img alt="MNIST sample0" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/0.png" /></td>
<td style="text-align:center"><img alt="MNIST sample1" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/1.png" /></td>
<td style="text-align:center"><img alt="MNIST sample2" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/2.png" /></td>
<td style="text-align:center"><img alt="MNIST sample3" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/3.png" /></td>
<td style="text-align:center"><img alt="MNIST sample4" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/4.png" /></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">6</td>
<td style="text-align:center">7</td>
<td style="text-align:center">8</td>
<td style="text-align:center">9</td>
</tr>
<tr>
<td style="text-align:center"><img alt="MNIST sample5" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/5.png" /></td>
<td style="text-align:center"><img alt="MNIST sample6" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/6.png" /></td>
<td style="text-align:center"><img alt="MNIST sample7" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/7.png" /></td>
<td style="text-align:center"><img alt="MNIST sample8" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/8.png" /></td>
<td style="text-align:center"><img alt="MNIST sample9" src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/MNIST-sample/9.png" /></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">kerasy.datasets</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="kn">from</span> <span class="nn">kerasy.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">kerasy.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">MaxPooling2D</span><span class="p">,</span> <span class="n">Input</span>
<span class="kn">from</span> <span class="nn">kerasy.utils</span> <span class="kn">import</span> <span class="n">CategoricalEncoder</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Datasets Parameters.</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1_000</span>

<span class="c1"># Training Parameters.</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">keep_prob1</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="n">keep_prob2</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># input image dimensions</span>
<span class="n">img_rows</span><span class="p">,</span> <span class="n">img_cols</span> <span class="o">=</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># the data, split between train and test sets</span>
<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_test</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span>  <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">img_rows</span><span class="p">,</span> <span class="n">img_cols</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">]</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float64'</span><span class="p">)</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">x_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float64'</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">/=</span> <span class="mi">255</span>
<span class="n">x_test</span> <span class="o">/=</span> <span class="mi">255</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'x_train shape:'</span><span class="p">,</span> <span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">'train samples'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">'test samples'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>x_train shape: (1000, 28, 28, 1)
1000 train samples
1000 test samples
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># convert class vectors to binary class matrices</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">CategoricalEncoder</span><span class="p">()</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">to_onehot</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
<span class="n">y_test</span>  <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">to_onehot</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Dictionaly for Encoder is already made.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="n">keep_prob</span><span class="o">=</span><span class="n">keep_prob1</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="n">keep_prob</span><span class="o">=</span><span class="n">keep_prob2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s1">'adagrad'</span><span class="p">,</span> 
    <span class="n">loss</span><span class="o">=</span><span class="s1">'categorical_crossentropy'</span><span class="p">,</span> 
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'categorical_accuracy'</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/iwasakishuto/Github/portfolio/Kerasy/kerasy/engine/sequential.py:67: UserWarning: <span class="ansi-red-fg">Kerasy Warnings</span>
------------------------------------------------------------
When calculating the <span class="ansi-blue-fg">CategoricalCrossentropy</span> loss and the derivative of the <span class="ansi-blue-fg">Softmax</span> layer, the gradient disappears when backpropagating the actual value, so the <span class="ansi-blue-fg">SoftmaxCategoricalCrossentropy</span> is implemented instead.
------------------------------------------------------------
  "so the \033[34mSoftmaxCategoricalCrossentropy\033[0m is implemented instead.\n" + '-'*60)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>-----------------------------------------------------------------
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (Input)              (None, 28, 28, 1)         0         
-----------------------------------------------------------------
conv2d_1 (Conv2D)            (None, 26, 26, 32)        320       
-----------------------------------------------------------------
conv2d_2 (Conv2D)            (None, 24, 24, 64)        18496     
-----------------------------------------------------------------
maxpooling2d_1 (MaxPooling2D (None, 12, 12, 64)        0         
-----------------------------------------------------------------
dropout_1 (Dropout)          (None, 12, 12, 64)        0         
-----------------------------------------------------------------
flatten_1 (Flatten)          (None, 9216)              0         
-----------------------------------------------------------------
dense_1 (Dense)              (None, 128)               1179776   
-----------------------------------------------------------------
dropout_2 (Dropout)          (None, 128)               0         
-----------------------------------------------------------------
dense_2 (Dense)              (None, 10)                1290      
=================================================================
Total params: 1,199,882
Trainable params: 1,199,882
Non-trainable params: 0
-----------------------------------------------------------------
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 01/20 | 63/63[####################]100.00% - 1442.691[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">1381.319</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">54.4%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">740.757</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">78.9%</span>
Epoch 02/20 | 63/63[####################]100.00% - 1439.734[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">573.693</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">83.7%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">584.554</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">86.2%</span>
Epoch 03/20 | 63/63[####################]100.00% - 1318.618[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">405.320</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">88.2%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">418.508</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">90.4%</span>
Epoch 04/20 | 63/63[####################]100.00% - 1010.807[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">318.465</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">90.0%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">440.983</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">90.1%</span>
Epoch 05/20 | 63/63[####################]100.00% - 1020.449[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">261.625</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">92.6%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">496.641</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">89.6%</span>
Epoch 06/20 | 63/63[####################]100.00% - 1018.260[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">215.082</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">92.9%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">419.564</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.7%</span>
Epoch 07/20 | 63/63[####################]100.00% - 1013.837[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">168.225</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">95.0%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">461.159</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">91.4%</span>
Epoch 08/20 | 63/63[####################]100.00% - 1013.345[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">164.291</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">95.1%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">479.793</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">91.0%</span>
Epoch 09/20 | 63/63[####################]100.00% - 1021.595[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">134.688</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">96.0%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">450.356</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">91.4%</span>
Epoch 10/20 | 63/63[####################]100.00% - 1012.004[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">132.845</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">96.3%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">449.674</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.1%</span>
Epoch 11/20 | 63/63[####################]100.00% - 1015.242[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">113.595</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">96.2%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">480.528</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.1%</span>
Epoch 12/20 | 63/63[####################]100.00% - 1015.592[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">93.535</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">96.8%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">497.775</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">91.7%</span>
Epoch 13/20 | 63/63[####################]100.00% - 1021.730[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">95.980</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">96.9%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">477.428</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">91.8%</span>
Epoch 14/20 | 63/63[####################]100.00% - 1020.249[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">68.847</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">98.3%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">520.389</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">91.4%</span>
Epoch 15/20 | 63/63[####################]100.00% - 1020.915[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">84.820</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">96.9%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">517.873</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">91.9%</span>
Epoch 16/20 | 63/63[####################]100.00% - 1019.250[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">70.326</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">97.7%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">509.199</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.7%</span>
Epoch 17/20 | 63/63[####################]100.00% - 1012.677[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">71.140</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">97.4%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">475.805</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.6%</span>
Epoch 18/20 | 63/63[####################]100.00% - 1013.460[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">71.360</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">98.0%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">548.380</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.2%</span>
Epoch 19/20 | 63/63[####################]100.00% - 1043.271[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">65.436</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">97.8%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">480.036</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.5%</span>
Epoch 20/20 | 63/63[####################]100.00% - 1163.611[s]   <span class="ansi-bold">categorical_crossentropy</span>: <span class="ansi-blue-fg">47.725</span>, <span class="ansi-bold">categorical_accuracy</span>: <span class="ansi-blue-fg">98.5%</span>, <span class="ansi-bold">val_categorical_crossentropy</span>: <span class="ansi-blue-fg">519.467</span>, <span class="ansi-bold">val_categorical_accuracy</span>: <span class="ansi-blue-fg">92.3%</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="s2">"MNIST_example_notebook_adagrad.pickle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

        </section>
    </div>
</div>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Optimizers/" class="btn btn-neutral float-right" title="Optimizers">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../.." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../.." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Optimizers/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
